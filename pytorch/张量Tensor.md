# å¼ é‡Tensor

## å¼ é‡çš„åˆ›å»º

| å‡½æ•°å                                                       | å‡½æ•°ä½œç”¨                                          |
| ------------------------------------------------------------ | ------------------------------------------------- |
| torch.tensor(a)                                              | æŠŠç±»å‹aåˆ›å»ºæˆTensorç±»å‹                           |
| torch.Tensor(ints)                                           | åˆ›å»ºintsæŒ‡å®šå½¢çŠ¶çš„å¼ é‡ï¼Œé»˜è®¤dtype=float32         |
| torch.IntTensor(...)<br>torch.ShortTensor(...)<br/>torch.LongTensor(...)<br/>torch.FloatTensor(...)<br/>torch.DoubleTensor(...)<br/> | ä½¿ç”¨å…·ä½“ç±»å‹çš„å¼ é‡                                |
| torch.arange(start,end,step)                                 | è‹¥æœ‰start,endåˆ™ä¸ºéµå¾ªå·¦é—­å³å¼€åŸåˆ™ï¼Œè‹¥å•å‚æ•°ä¸ºé•¿åº¦ |
| torch.linspace((start,end,count)                             | åœ¨æŒ‡å®šåŒºé—´æŒ‰ç…§å…ƒç´ ä¸ªæ•°ç”Ÿæˆ,å¯å–end                |
| torch.randn(row,col)                                         | åˆ›å»ºéšæœºå¼ é‡                                      |
| torch.random.manual_seed(n)                                  | åˆ›å»ºéšæœºå¼ é‡è®¾ç½®éšæœºæ•°ç§å­ä¸ºn                     |
| torch.random.initial_seed()                                  | æŸ¥çœ‹éšæœºæ•°ç§å­å€¼                                  |
| torch.ones(row,col)<br>torch.ones_like(Tensor)               | åˆ›å»ºå…¨1å¼ é‡                                       |
| torch.zeros(row,col)<br/>torch.zeros_like(Tensor)            | åˆ›å»ºå…¨0å¼ é‡                                       |
| torch.full([row,col],num)<br/>torch.zeros_like(tensor,num)   | åˆ›å»ºæ•°å€¼ä¸ºnumçš„å¼ é‡                               |
| t1.type(torch.DoubleTensor)<br>t1.double()                   | ç±»å‹è½¬æ¢ï¼Œæœ‰å¤šç§                                  |



## å¼ é‡æ•°å€¼è®¡ç®—

| å‡½æ•°å                                                       | å‡½æ•°ä½œç”¨                                                     |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| t1.add(nub)<br>t1.add_(nub)                                  | å¼ é‡åŠ æŸå¸¸é‡ï¼Œå¸¦_ä¼šæ”¹å˜åŸæ•°æ®                                |
| t1.sub(nub)<br>t1.sub_(nub)                                  | å‡æ³•                                                         |
| t1.mul(nub)<br/>t1.mul_(nub)                                 | ä¹˜æ³•                                                         |
| t1.div(nub)<br/>t1.div_(nub)                                 | é™¤æ³•                                                         |
| t1.neg(nub)<br/>t1.neg_(nub)                                 | åŠ è´Ÿå·                                                       |
| torch.mul(t1,t2)<br>t1*t2                                    | é˜¿è¾¾ç›ç§¯:æŒ‡çš„æ˜¯çŸ©é˜µå¯¹åº”ä½ç½®çš„å…ƒç´ ç›¸ä¹˜                        |
| t1@t2<br>torch.mm(t1,t2)<br>torch.bmm(t1,t2)<br>torch.matmul(t1,t2) | è¿ç®—ç¬¦ @ ç”¨äºè¿›è¡Œä¸¤ä¸ªçŸ©é˜µçš„ç‚¹ä¹˜è¿ç®—<br> torch.mm ç”¨äºè¿›è¡Œä¸¤ä¸ªçŸ©é˜µç‚¹ä¹˜è¿ç®—, è¦æ±‚è¾“å…¥çš„çŸ©é˜µä¸º2ç»´<br/> torch.bmm ç”¨äºæ‰¹é‡è¿›è¡ŒçŸ©é˜µç‚¹ä¹˜è¿ç®—, è¦æ±‚è¾“å…¥çš„çŸ©é˜µä¸º3ç»´ <br/>torch.matmul å¯¹è¿›è¡Œç‚¹ä¹˜è¿ç®—çš„ä¸¤çŸ©é˜µå½¢çŠ¶æ²¡æœ‰é™å®š. <br/> å¯¹äºè¾“å…¥éƒ½æ˜¯äºŒç»´çš„å¼ é‡ç›¸å½“äº mm è¿ç®—. <br/>å¯¹äºè¾“å…¥éƒ½æ˜¯ä¸‰ç»´çš„å¼ é‡ç›¸å½“äº bmm è¿ç®— <br/>å¯¹æ•°è¾“å…¥çš„ shape ä¸åŒçš„å¼ é‡, å¯¹åº”çš„æœ€åå‡ ä¸ªç»´åº¦å¿…é¡»ç¬¦åˆçŸ©é˜µè¿ç®—è§„åˆ™ |

###  æŒ‡å®šè¿ç®—è®¾å¤‡

PyTorch é»˜è®¤ä¼šå°†å¼ é‡åˆ›å»ºåœ¨ CPU æ§åˆ¶çš„å†…å­˜ä¸­, å³: é»˜è®¤çš„è¿ç®—è®¾å¤‡ä¸º CPUã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å¼ é‡åˆ›å»ºåœ¨ GPU ä¸Š, èƒ½å¤Ÿåˆ©ç”¨å¯¹äºçŸ©é˜µè®¡ç®—çš„ä¼˜åŠ¿åŠ å¿«æ¨¡å‹è®­ç»ƒã€‚å°†å¼ é‡ç§»åŠ¨åˆ° GPU ä¸Šæœ‰ä¸¤ç§æ–¹æ³•: 1. ä½¿ç”¨ cuda æ–¹æ³• 2. ç›´æ¥åœ¨ GPU ä¸Šåˆ›å»ºå¼ é‡ 3. ä½¿ç”¨ to æ–¹æ³•æŒ‡å®šè®¾å¤‡

```python
import numpy as np
import torch

t1=torch.tensor([10,20,30])
print('å­˜å‚¨è®¾å¤‡:', data.device)


```



## å¼ é‡ç±»å‹è½¬æ¢

## å¼ é‡æ‹¼æ¥æ“ä½œ

| å‡½æ•°å                       | å‡½æ•°ä½œç”¨                                                     |
| ---------------------------- | ------------------------------------------------------------ |
| torch.cat((t1,t2,...),dim=0) | æŠŠå¼ é‡t1,t2,...æ‹¼æ¥æˆä¸€ä¸ªå¼ é‡ï¼Œdim=0æ²¿è¡Œæ–¹å‘æ‹¼æ¥ï¼Œdim=1æ²¿åˆ—æ–¹å‘æ‹¼æ¥ï¼Œdim=2æ²¿æ·±åº¦æ–¹å‘æ‹¼æ¥ |
| torch.stack(tensors,dim=0)   | æ²¿**æ–°ç»´åº¦**å †å å¤šä¸ªå¼ é‡ï¼ˆåˆ›å»ºæ–°ç»´åº¦ï¼‰                       |

### 1.PyTorch `torch.cat()` æ–¹æ³•è¯¦è§£ï¼š`dim` å‚æ•°çš„ä½¿ç”¨

`torch.cat()` æ˜¯ PyTorch ä¸­æœ€å¸¸ç”¨çš„å¼ é‡æ‹¼æ¥æ–¹æ³•ï¼Œè€Œ `dim` å‚æ•°å†³å®šäº†æ‹¼æ¥çš„æ–¹å‘ã€‚ä¸‹é¢æˆ‘å°†è¯¦ç»†è§£æ `dim` å‚æ•°çš„ä½¿ç”¨æ–¹æ³•ï¼Œé€šè¿‡å¤šç»´å¼ é‡ç¤ºä¾‹æ¼”ç¤ºå…¶å·¥ä½œæœºåˆ¶ã€‚

#### 1.æ ¸å¿ƒæ¦‚å¿µï¼š`dim` å‚æ•°çš„å«ä¹‰

`dim` å‚æ•°æŒ‡å®šäº†**æ²¿ç€å“ªä¸ªç»´åº¦è¿›è¡Œæ‹¼æ¥**ï¼š

- `dim=0`ï¼šæ²¿è¡Œæ–¹å‘ï¼ˆå‚ç›´æ‹¼æ¥ï¼‰
- `dim=1`ï¼šæ²¿åˆ—æ–¹å‘ï¼ˆæ°´å¹³æ‹¼æ¥ï¼‰
- `dim=2`ï¼šæ²¿æ·±åº¦æ–¹å‘ï¼ˆé€šé“æ–¹å‘ï¼‰
- ä»¥æ­¤ç±»æ¨ï¼Œå¯¹äºæ›´é«˜ç»´å¼ é‡

#### 2.åŸºæœ¬è§„åˆ™

1. **æ‰€æœ‰éæ‹¼æ¥ç»´åº¦å¿…é¡»å®Œå…¨ç›¸åŒ**
2. **æ‹¼æ¥ç»´åº¦çš„å¤§å°å¯ä»¥ä¸åŒ**
3. **è¾“å‡ºå¼ é‡çš„æ‹¼æ¥ç»´åº¦å°ºå¯¸ = æ‰€æœ‰è¾“å…¥å¼ é‡åœ¨è¯¥ç»´åº¦å°ºå¯¸ä¹‹å’Œ**

#### 3. dimå‚æ•°ä½¿ç”¨æ€»ç»“è¡¨

| æ•°æ®ç±»å‹      | `dim=0`            | `dim=1`                | `dim=2`          | `dim=3`  |
| ------------- | ------------------ | ---------------------- | ---------------- | -------- |
| å‘é‡ (1D)     | å»¶é•¿å‘é‡           | -                      | -                | -        |
| çŸ©é˜µ (2D)     | å‚ç›´æ‹¼æ¥ï¼ˆå¢åŠ è¡Œï¼‰ | æ°´å¹³æ‹¼æ¥ï¼ˆå¢åŠ åˆ—ï¼‰     | -                | -        |
| å›¾åƒç‰¹å¾ (3D) | å¢åŠ æ ·æœ¬æ•°         | å¢åŠ è¡Œæ•°(é«˜åº¦)         | å¢åŠ åˆ—æ•°ï¼ˆå®½åº¦ï¼‰ | -        |
| å›¾åƒæ‰¹æ¬¡ (4D) | å¢åŠ æ‰¹æ¬¡å¤§å°       | å¢åŠ é€šé“æ•°ï¼ˆè‰²å½©é€šé“ï¼‰ | å¢åŠ é«˜åº¦         | å¢åŠ å®½åº¦ |

###  `2.torch.stack()` åŠ `dim` åƒæ•¸ç”¨æ³•

#### 1. **torch.stack() çš„æ ¸å¿ƒåŠŸèƒ½**

- **å°‡å¤šå€‹å¼µé‡ï¼ˆtensorsï¼‰æ²¿è‘—ä¸€å€‹æ–°çš„ç¶­åº¦ï¼ˆdimensionï¼‰å †ç–Š**ã€‚
- è¼¸å…¥çš„æ‰€æœ‰å¼µé‡å¿…é ˆå…·æœ‰**å®Œå…¨ç›¸åŒçš„å½¢ç‹€ï¼ˆshapeï¼‰**ã€‚
- è¼¸å‡ºå¼µé‡æœƒæ¯”è¼¸å…¥å¼µé‡**å¤šå‡ºä¸€å€‹ç¶­åº¦**ï¼ˆæ–°ç¶­åº¦ç”± `dim` åƒæ•¸æŒ‡å®šï¼‰ã€‚

#### 2.è¯­æ³•

```python
torch.stack(tensors, dim=0, *, out=None)
```



#### 3.å…³é”®æ¦‚å¿µï¼š`dim` å‚æ•°çš„ä½œç”¨

`dim` æ±ºå®šæ–°ç¶­åº¦æ’å…¥çš„ä½ç½®ï¼š

- **dim=0**ï¼šæ–°ç¶­åº¦æˆç‚º**æœ€å¤–å±¤**ï¼ˆå¦‚å°‡ `N` å€‹å½¢ç‹€ç‚º `(A, B)` çš„å¼µé‡ â†’ å †ç–Šç‚º `(N, A, B)`ï¼‰ã€‚
- **dim=1**ï¼šæ–°ç¶­åº¦æ’å…¥åœ¨**ç¬¬ 1 ç¶­**ï¼ˆåŸç¬¬ 0 ç¶­ä¹‹å¾Œï¼‰ã€‚
- **dim=-1(2ä¹Ÿå¯ä»¥ï¼Œ-1å’Œ2çš„æ“ä½œæ˜¯ä¸€è‡´çš„)**ï¼šæ–°ç¶­åº¦æˆç‚º**æœ€å…§å±¤**ï¼ˆè¿½åŠ åˆ°æœ€å¾Œï¼‰ã€‚

> ğŸ“Œ **é‡è¦è¦å‰‡**ï¼šè¼¸å‡ºå¼µé‡çš„ç¶­åº¦æ•¸ = è¼¸å…¥å¼µé‡ç¶­åº¦æ•¸ + 1ã€‚
>
> eg:
>
> ```python
> import torch
> 
> t1=torch.tensor([[1,2],[3,4]])
> t2=torch.tensor([[5,6],[7,8]])
> #dim=0
> t3=torch.stack([t1,t2],dim=0)
> #dim=1
> t3=torch.stack([t1,t2],dim=1)
> #dim=-1ï¼ˆ2ä¹Ÿè¡Œï¼‰
> t3=torch.stack([t1,t2],dim=-1)
> ```
>
> ![20250718_112326.jpg](.\å¼ é‡img\20250718_112326.jpg)





## å¼ é‡ç´¢å¼•æ“ä½œ

torch.tensorçš„ç´¢å¼•æ“ä½œä¸numpyçš„å‘é‡ã€çŸ©é˜µçš„ç´¢å¼•æ“ä½œæä¸ºç›¸ä¼¼ï¼Œå‡ ä¹å¯ä»¥çœ‹åšä¸€æ ·ã€‚ç†Ÿæ‚‰numpyç´¢å¼•æ“ä½œæ–¹å¼å¯ä»¥è·³è¿‡æœ¬æ®µ

### 1.åŸºæœ¬ç´¢å¼•

##### å•å…ƒç´  ç´¢å¼• arr[row,col] 

```python
import torch
t1 = torch.tensor([[1, 2, 3], [4, 5, 6]])
print(t1[0, 1])  # ç´¢å¼•0è¡Œ1åˆ—çš„æ•°å€¼-ã€‹ è¾“å‡º 2
```

##### åˆ‡ç‰‡ç´¢å¼• arr[start : end :step ,start : end : step ]

```python
print(t1[:, 1:3])  # æ‰€æœ‰è¡Œçš„ç¬¬ 1-2 åˆ— (å·¦é—­å³å¼€åŸåˆ™)
# è¾“å‡ºï¼š
# [[2 3]
#  [5 6]]
```

### 2.é«˜çº§ç´¢å¼•

##### åˆ—è¡¨ç´¢å¼•

```python
print(arr[[0, 1], [0, 2]])  # å– (0,0) å’Œ (1,2) çš„å…ƒç´ 
# è¾“å‡º [1, 6]
```

##### å¸ƒå°”ç´¢å¼•

```python
print(t1[arr > 3])  # è¾“å‡ºæ‰€æœ‰å¤§äº 3 çš„å…ƒç´ ï¼š[4, 5, 6]
```

##### å¤šç»´ç´¢å¼•

```python
arr3d = torch.tensor([[[1, 2], [3, 4]], [[[5, 6], [7, 8]]])
print(arr3d[0, 1, 0])  # è¾“å‡º 3 arr3d[zï¼Œxï¼Œy]
```

## å¼ é‡å½¢çŠ¶æ“ä½œ

| å‡½æ•°å                   | å‡½æ•°ä½œç”¨                                                     |
| ------------------------ | ------------------------------------------------------------ |
| t1.reshape(shape)        | **è¿”å›å…·æœ‰ç›¸åŒæ•°æ®ä½†æ–°å½¢çŠ¶çš„æ–°å¼ é‡**.<br> **t1**: è¦é‡å¡‘çš„å¼ é‡;**shape**:ç›®æ ‡å½¢çŠ¶çš„å…ƒç»„ï¼ˆtuple) |
| t1.transpose(dim0, dim1) | **åŠŸèƒ½**ï¼šäº¤æ¢æŒ‡å®šçš„ä¸¤ä¸ªç»´åº¦ <br>**å‚æ•°**ï¼š  `dim0`ï¼šç¬¬ä¸€ä¸ªè¦äº¤æ¢çš„ç»´åº¦ `dim1`ï¼šç¬¬äºŒä¸ªè¦äº¤æ¢çš„ç»´åº¦ |
| t1.permute(dims)         | **åŠŸèƒ½**ï¼šæŒ‰æŒ‡å®šé¡ºåºé‡æ–°æ’åˆ—æ‰€æœ‰ç»´åº¦<br> **å‚æ•°**ï¼š`*dims` - æ–°ç»´åº¦é¡ºåºçš„æ•´æ•°åºåˆ— |
| view                     | **æ”¹å˜å¼ é‡çš„å½¢çŠ¶ï¼ˆshapeï¼‰**ï¼Œä½†**ä¸æ”¹å˜æ•°æ®å†…å®¹**å’Œ**å…ƒç´ é¡ºåº** è¦æ±‚å¼ é‡çš„**å…ƒç´ æ€»æ•°ä¸å˜**ï¼ˆå³ `numel()` ä¸å˜ï¼‰ **å¿…é¡»å†…å­˜è¿ç»­**ï¼ˆæˆ–æ˜¾å¼è°ƒç”¨ `contiguous()`ï¼‰ |
| contigous                | **ç¡®ä¿å¼ é‡åœ¨å†…å­˜ä¸­æ˜¯è¿ç»­çš„** å¦‚æœå¼ é‡**åŸæœ¬ä¸è¿ç»­**ï¼Œä¼š**å¤åˆ¶æ•°æ®**å¹¶è¿”å›ä¸€ä¸ªæ–°çš„è¿ç»­å¼ é‡ å¦‚æœå¼ é‡**åŸæœ¬è¿ç»­**ï¼Œåˆ™**ç›´æ¥è¿”å›åŸå¼ é‡** |
| squeeze                  | å‡½æ•°ç”¨åˆ é™¤ shape ä¸º 1 çš„ç»´åº¦                                 |
| unsqueeze                | åœ¨æ¯ä¸ªç»´åº¦æ·»åŠ  1, ä»¥å¢åŠ æ•°æ®çš„å½¢çŠ¶                           |

### PyTorch ä¸­çš„ `reshape()` å‡½æ•°è¯¦è§£

#### æ ¸å¿ƒç‰¹æ€§

1. **æ•°æ®ä¸å˜æ€§**ï¼šåªæ”¹å˜å½¢çŠ¶ï¼Œä¸æ”¹å˜æ•°æ®å†…å®¹å’Œé¡ºåº

2. **å…ƒç´ æ€»æ•°ä¸å˜**ï¼šæ–°å½¢çŠ¶çš„å…ƒç´ æ€»æ•°å¿…é¡»ä¸åŸå¼ é‡ç›¸åŒ

3. **å†…å­˜è¿ç»­æ€§**ï¼šå°½å¯èƒ½è¿”å›è§†å›¾ï¼ˆå…±äº«å†…å­˜ï¼‰ï¼Œå¿…è¦æ—¶è¿”å›æ‹·è´

4. **è‡ªåŠ¨ç»´åº¦è®¡ç®—**ï¼šæ”¯æŒä½¿ç”¨ `-1` è‡ªåŠ¨è®¡ç®—ç»´åº¦å¤§å°

5. **å˜åŒ–æ–¹å¼ï¼š**è‡ªå·¦å‘å³ï¼Œè‡ªä¸Šå‘ä¸‹ï¼Œè‡ªå‰å‘å

   ![20250718_160452.jpg](.\å¼ é‡img\20250718_160452.jpg)

#### å‚æ•°è¯¦è§£

#### `shape` å‚æ•°è§„åˆ™

- å¿…é¡»æ˜¯**æ•´æ•°å…ƒç»„**ï¼ˆå¦‚ `(3, 4)`ï¼‰
- å¯ä»¥ä½¿ç”¨ `-1` è¡¨ç¤ºè‡ªåŠ¨è®¡ç®—è¯¥ç»´åº¦å¤§å°
- å„ç»´åº¦å¤§å°çš„ä¹˜ç§¯å¿…é¡»ç­‰äºåŸå¼ é‡å…ƒç´ æ€»æ•°

#### ä½¿ç”¨ç¤ºä¾‹

##### åŸºç¡€ç”¨æ³•

```python
import torch

# åˆ›å»º 1x12 å¼ é‡
t = torch.arange(12)  # tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11])

# é‡å¡‘ä¸º 3x4 çŸ©é˜µ
reshaped = t.reshape(3, 4)
"""
tensor([[ 0,  1,  2,  3],
        [ 4,  5,  6,  7],
        [ 8,  9, 10, 11]])
"""
```

##### è‡ªåŠ¨ç»´åº¦è®¡ç®—ï¼ˆä½¿ç”¨ -1ï¼‰

```python
# è‡ªåŠ¨è®¡ç®—è¡Œæ•°
auto_row = t.reshape(-1, 3)  # 4x3 çŸ©é˜µ

# è‡ªåŠ¨è®¡ç®—åˆ—æ•°
auto_col = t.reshape(4, -1)  # 4x3 çŸ©é˜µ

# è‡ªåŠ¨è®¡ç®—ä¸­é—´ç»´åº¦
auto_mid = t.reshape(2, -1, 3)  # 2x2x3 å¼ é‡
```

##### å¢åŠ /å‡å°‘ç»´åº¦

```python
# å¢åŠ ç»´åº¦ï¼ˆä»2Dåˆ°3Dï¼‰
matrix = torch.randn(4, 3)
tensor_3d = matrix.reshape(2, 2, 3)

# å‡å°‘ç»´åº¦ï¼ˆå±•å¹³ï¼‰
flattened = tensor_3d.reshape(-1)  # 1Då‘é‡
```

### PyTorch ä¸­çš„ `transpose` ä¸ `permute` å‡½æ•°è¯¦è§£

transpose å‡½æ•°å¯ä»¥å®ç°äº¤æ¢å¼ é‡å½¢çŠ¶çš„æŒ‡å®šç»´åº¦, ä¾‹å¦‚: ä¸€ä¸ªå¼ é‡çš„å½¢çŠ¶ä¸º (2, 3, 4) å¯ä»¥é€šè¿‡ transpose å‡½æ•°æŠŠ 3 å’Œ 4 è¿›è¡Œäº¤æ¢, å°†å¼ é‡çš„å½¢çŠ¶å˜ä¸º (2, 4, 3)



#### 1. `torch.transpose()` - ç»´åº¦äº¤æ¢

##### ä½¿ç”¨ç¤ºä¾‹

```python
import torch

# åˆ›å»º3ç»´å¼ é‡ (batch, channels, height)
x = torch.randn(2, 3, 4)  # å½¢çŠ¶: [2, 3, 4]

# äº¤æ¢ç»´åº¦0å’Œ1
y = x.transpose(0, 1)  # å½¢çŠ¶å˜ä¸º [3, 2, 4]

# äº¤æ¢ç»´åº¦1å’Œ2
z = x.transpose(1, 2)  # å½¢çŠ¶å˜ä¸º [2, 4, 3]
```



##### å›¾åƒå¤„ç†åº”ç”¨

```python
# å›¾åƒå¼ é‡æ ¼å¼è½¬æ¢ (NCHW â†” NHWC)
images = torch.randn(16, 3, 32, 32)  # NCHWæ ¼å¼

# è½¬æ¢ä¸ºNHWCæ ¼å¼
nhwc = images.transpose(1, 2).transpose(2, 3)  # å½¢çŠ¶ [16, 32, 32, 3]

# è½¬æ¢å›NCHWæ ¼å¼
nchw = nhwc.transpose(2, 3).transpose(1, 2)  # å½¢çŠ¶ [16, 3, 32, 32]
```

#### 2. `torch.permute()` - ç»´åº¦é‡æ’

##### ä½¿ç”¨ç¤ºä¾‹

```python
# åˆ›å»º4ç»´å¼ é‡ (batch, channels, height, width)
x = torch.randn(2, 3, 4, 5)  # å½¢çŠ¶: [2, 3, 4, 5]

# é‡æ’ç»´åº¦é¡ºåº
y = x.permute(0, 2, 3, 1)  # å½¢çŠ¶å˜ä¸º [2, 4, 5, 3]
z = x.permute(2, 0, 1, 3)  # å½¢çŠ¶å˜ä¸º [4, 2, 3, 5]

# å®ç°è½¬ç½®çš„ç­‰æ•ˆæ“ä½œ
transpose_equivalent = x.permute(0, 1, 3, 2)  # ç­‰ä»·äº x.transpose(2, 3)
```

##### åºåˆ—æ•°æ®å¤„ç†

```python
# æ—¶é—´åºåˆ—æ•°æ® (batch, seq_len, features)
seq_data = torch.randn(10, 20, 50)  # [batch, seq, features]

# è½¬æ¢ä¸ºæ³¨æ„åŠ›æœºåˆ¶éœ€è¦çš„æ ¼å¼ (seq_len, batch, features)
attn_input = seq_data.permute(1, 0, 2)  # å½¢çŠ¶ [20, 10, 50]
```

#####  å…³é”®åŒºåˆ«å¯¹æ¯”

| ç‰¹æ€§             | `transpose()`    | `permute()`          |
| ---------------- | ---------------- | -------------------- |
| **ç»´åº¦æ•°é‡**     | åªèƒ½äº¤æ¢ä¸¤ä¸ªç»´åº¦ | å¯ä»¥é‡æ’ä»»æ„å¤šä¸ªç»´åº¦ |
| **æ“ä½œå¤æ‚åº¦**   | ç®€å•äº¤æ¢         | å®Œå…¨é‡æ’             |
| **ä½¿ç”¨åœºæ™¯**     | ç®€å•ç»´åº¦äº¤æ¢     | å¤æ‚ç»´åº¦é‡æ’         |
| **å‚æ•°æ•°é‡**     | å›ºå®šä¸¤ä¸ªå‚æ•°     | å¯å˜å‚æ•°ï¼ˆç»´åº¦æ•°é‡ï¼‰ |
| **å®ç°ç›¸åŒæ“ä½œ** | éœ€å¤šæ¬¡è°ƒç”¨       | å•æ¬¡è°ƒç”¨å®Œæˆ         |
| **å†…å­˜å…±äº«**     | æ˜¯ï¼ˆè§†å›¾ï¼‰       | æ˜¯ï¼ˆè§†å›¾ï¼‰           |

#### 3.**view() å‡½æ•°**

##### **ä½¿ç”¨ç¤ºä¾‹**

```python
import torch

# åŸå§‹å¼ é‡ (6 ä¸ªå…ƒç´ )
x = torch.arange(6)  # shape: [6]

# æ”¹å˜å½¢çŠ¶ä¸º 2x3
y = x.view(2, 3)
"""
y = 
tensor([[0, 1, 2],
        [3, 4, 5]])
"""

# æ”¹å˜å½¢çŠ¶ä¸º 3x2
z = x.view(3, 2)
"""
z = 
tensor([[0, 1],
        [2, 3],
        [4, 5]])
"""
```



##### **-1 è‡ªåŠ¨è®¡ç®—ç»´åº¦**

å¦‚æœæŸä¸ªç»´åº¦ä¸ç¡®å®šï¼Œå¯ä»¥ç”¨ `-1`ï¼ŒPyTorch ä¼šè‡ªåŠ¨è®¡ç®—ï¼š

```python
x = torch.arange(12)  # shape: [12]

# è‡ªåŠ¨è®¡ç®—è¡Œæ•°ï¼Œåˆ—æ•°ä¸º 4
y = x.view(-1, 4)    # shape: [3, 4]
```

##### **view() çš„é™åˆ¶**

- **å¿…é¡»å†…å­˜è¿ç»­**ï¼ˆå¦åˆ™ä¼šæŠ¥é”™ï¼‰
- **ä¸èƒ½æ”¹å˜å…ƒç´ é¡ºåº**ï¼ˆ`reshape()` å¯ä»¥ï¼Œä½† `view()` ä¸è¡Œ

#### 4.**contiguous() å‡½æ•°**

##### **ä¸ºä»€ä¹ˆéœ€è¦ contiguous()ï¼Ÿ**

PyTorch çš„æŸäº›æ“ä½œï¼ˆå¦‚ `transpose()`ã€`permute()`ï¼‰ä¼š**æ”¹å˜å¼ é‡çš„å†…å­˜å¸ƒå±€**ï¼Œå¯¼è‡´**éè¿ç»­å­˜å‚¨**ï¼š

```python
x = torch.arange(6).view(2, 3)  # shape: [2, 3]
y = x.transpose(0, 1)           # shape: [3, 2]

print(x.is_contiguous())  # True
print(y.is_contiguous())  # Falseï¼ˆè½¬ç½®åä¸è¿ç»­ï¼‰
```

æ­¤æ—¶ï¼Œå¦‚æœç›´æ¥ `y.view(6)` ä¼šæŠ¥é”™

##### **è§£å†³æ–¹æ¡ˆ**

å…ˆ `contiguous()`ï¼Œå† `view()`ï¼š

```python
y_contig = y.contiguous()  # ç¡®ä¿å†…å­˜è¿ç»­
y_reshaped = y_contig.view(6)  # âœ… æ­£ç¡®
```



#### 5.**view() vs reshape()**

| å‡½æ•°           | æ˜¯å¦å…±äº«å†…å­˜         | æ˜¯å¦è¦æ±‚è¿ç»­ | é€‚ç”¨åœºæ™¯           |
| -------------- | -------------------- | ------------ | ------------------ |
| `view()`       | âœ… æ˜¯ï¼ˆè§†å›¾ï¼‰         | âŒ å¿…é¡»è¿ç»­   | **é«˜æ•ˆæ”¹å˜å½¢çŠ¶**   |
| `reshape()`    | âœ… å¯èƒ½ï¼ˆè§†å›¾æˆ–æ‹·è´ï¼‰ | âŒ ä¸è¦æ±‚     | **æ›´çµæ´»**         |
| `contiguous()` | âŒ å¯èƒ½æ‹·è´           | âœ… ç¡®ä¿è¿ç»­   | **ä¿®å¤éè¿ç»­å¼ é‡** |

1. **ä¼˜å…ˆç”¨ view()**ï¼ˆæ›´é«˜æ•ˆï¼Œä½†è¦æ±‚è¿ç»­ï¼‰
2. **å¦‚æœå¼ é‡å¯èƒ½ä¸è¿ç»­ï¼Œå…ˆç”¨ contiguous()**
3. **ä¸ç¡®å®šæ—¶ç”¨ reshape()ï¼ˆä½†å¯èƒ½ç‰ºç‰²æ€§èƒ½ï¼‰**

#### 6.squeeze å’Œ unsqueeze å‡½æ•°çš„ç”¨æ³•

```python
t1=torch.tensor(np.random.randint(0,10,[1,3,1,5]))

#1.squeezeä½¿ç”¨
t2=t1.squeeze() #siez:[3,5]

#2.unsqueezeä½¿ç”¨
t3=t2.unsqueeze(-1) #å¢åŠ ä¸€ä¸ªç»´åº¦[3,5,1]
```

### å¼ é‡è¿ç®—å‡½æ•°

è®¡ç®—å‡å€¼ã€å¹³æ–¹æ ¹ã€æ±‚å’Œç­‰ç­‰

```python
t1=torch.randint(0,10,[2,3],dtype=torch.float64)

#1.å‡å€¼
t1.mean()#æ•´ä½“å‡å€¼
t1.mean(dim=0)#æŒ‰åˆ—
t1.mean(dim=1)#æŒ‰è¡Œ
#2.å’Œ
t1.sum()
...
#3.å¹³æ–¹
t1.pow(2)
#4.å¹³æ–¹æ ¹
t1.sqrt()
#ç­‰
```







